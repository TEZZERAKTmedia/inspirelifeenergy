import{r as i,b as S,u as V,j as e,a as y}from"./index-BvZ950ky.js";const k=()=>{const[t,o]=i.useState(null),[c,r]=i.useState(""),[g,m]=i.useState(""),[N,d]=i.useState(!1),[R,x]=i.useState(!1),f=S(),j=V(),h=()=>{const s=new URLSearchParams(f.search);return{email:s.get("email"),token:s.get("token")}};i.useEffect(()=>{const{email:s,token:n}=h(),l=localStorage.getItem("sessionId");s&&n?(async()=>{var v,p;try{const a=await y.get("/sign-up/create-account",{params:{email:s,token:n,sessionId:l}});a.status===200&&a.data.verified?(o("success"),r(`Verification successful. User ${s} moved to permanent table. You can now log in.`)):a.status===409?(o("email_registered"),r(a.data.message||`The email ${s} is already registered.`),x(!0)):(o("failed"),r(a.data.message||"Verification failed."))}catch(a){o("error"),r(((p=(v=a.response)==null?void 0:v.data)==null?void 0:p.message)||"Error verifying the account.")}})():r("Invalid or missing verification details.")},[f.search]);const E=async()=>{var n,l;const{email:s}=h();try{(await y.post("sign-up/resend-verification",{email:s})).status===200?(d(!0),m("Verification email has been resent. Please check your inbox.")):(d(!1),m("Failed to resend verification email. Please try again."))}catch(u){d(!1),m(((l=(n=u.response)==null?void 0:n.data)==null?void 0:l.message)||"Error resending verification email.")}};return e.jsxs("div",{className:"verify-email-container",children:[e.jsx("h1",{children:"Email Verification"}),t==="success"&&e.jsxs("div",{className:"success-message",children:[c,". Completing the process..."]}),t==="email_registered"&&e.jsxs("div",{className:"info-message",children:[c," You can log in to your account.",e.jsx("button",{onClick:()=>j("/login"),children:"Go to Login"})]}),t==="failed"&&e.jsxs("div",{className:"error-message",children:[c,". Please try again or contact support.",e.jsx("button",{onClick:E,children:"Resend Verification Email"})]}),t==="error"&&e.jsx("div",{className:"error-message",children:c}),!t&&e.jsx("div",{className:"loading-message",children:"Verifying your account..."}),g&&e.jsx("div",{className:"resend-message",children:g})]})};export{k as default};
