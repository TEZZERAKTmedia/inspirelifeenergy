import{r as a,u as P,j as e,a as z}from"./index-BvZ950ky.js";import{p as A}from"./purify.es-BlFzGd2J.js";import{e as k,a as q}from"./password-visibility-icon-reverse-7o_rWNZ4.js";const L=()=>{const[s,x]=a.useState(""),[u,f]=a.useState(""),[c,w]=a.useState(!1),[m,y]=a.useState(!1),[r,S]=a.useState({length:!1,upperLowerCase:!1,specialChar:!1,digit:!1}),[g,i]=a.useState(""),[h,v]=a.useState(""),b=P(),j=()=>{w(!c),y(!m)};a.useEffect(()=>{const o=s.length>=8,n=/(?=.*[a-z])(?=.*[A-Z])/.test(s),l=/(?=.*[@$!%*?&-])/.test(s),d=/(?=.*\d)/.test(s);S({length:o,upperLowerCase:n,specialChar:l,digit:d})},[s]);const C=async o=>{if(o.preventDefault(),!r.length||!r.upperLowerCase||!r.specialChar||!r.digit){i("Password must meet all requirements.");return}if(s!==u){i("Passwords do not match.");return}try{const l=new URLSearchParams(window.location.search).get("token");if(!l){i("Invalid or missing token.");return}const d=A.sanitize(s),p=await z.post("/register-cart/set-password",{token:l,password:d});p.status===200?(v(p.data.message),setTimeout(()=>b("/login"),2e3)):i(p.data.message)}catch(n){console.error("Error setting password:",n),i("An error occurred. Please try again later.")}};return e.jsxs("div",{style:t.container,children:[e.jsx("h2",{style:t.heading,children:"Set Your Password"}),e.jsxs("form",{onSubmit:C,style:t.form,children:[e.jsxs("div",{style:{position:"relative",marginBottom:"20px"},children:[e.jsx("input",{type:c?"text":"password",value:s,onChange:o=>x(o.target.value),placeholder:"Enter new password",required:!0,style:t.input}),e.jsx("img",{src:m?k:q,alt:"Toggle Password Visibility",onClick:j,style:t.toggleIcon})]}),e.jsxs("ul",{style:t.requirements,children:[e.jsx("li",{className:r.length?"valid":"invalid",children:"At least 8 characters long"}),e.jsx("li",{className:r.upperLowerCase?"valid":"invalid",children:"At least one uppercase and one lowercase letter"}),e.jsx("li",{className:r.specialChar?"valid":"invalid",children:"At least one special character (e.g., @, $, !)"}),e.jsx("li",{className:r.digit?"valid":"invalid",children:"At least one digit"})]}),e.jsx("input",{type:c?"text":"password",value:u,onChange:o=>f(o.target.value),placeholder:"Confirm password",required:!0,style:t.input}),g&&e.jsx("p",{style:t.error,children:g}),h&&e.jsx("p",{style:t.success,children:h}),e.jsx("button",{type:"submit",style:t.button,children:"Set Password"})]})]})},t={container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh",backgroundColor:"#f9f9f9",padding:"20px"},heading:{fontSize:"1.8rem",marginBottom:"20px",color:"#333"},form:{display:"flex",flexDirection:"column",width:"100%",maxWidth:"400px"},input:{padding:"10px",marginBottom:"15px",borderRadius:"5px",border:"1px solid #ccc",fontSize:"1rem",width:"100%"},toggleIcon:{position:"absolute",top:"50%",right:"10px",transform:"translateY(-50%)",cursor:"pointer",width:"24px",height:"24px"},requirements:{marginBottom:"15px",listStyle:"none",padding:0},error:{color:"red",marginBottom:"15px",fontSize:"0.9rem"},success:{color:"green",marginBottom:"15px",fontSize:"0.9rem"},button:{padding:"10px 15px",border:"none",borderRadius:"5px",background:"linear-gradient(to right, #28a745, #218838)",color:"#fff",fontSize:"1rem",cursor:"pointer",transition:"background-color 0.3s"}};export{L as default};
