import{r as t,b as S,u as N,j as e,a as y}from"./index-oHHnHrMu.js";/* empty css                     */const w=()=>{const[i,o]=t.useState(null),[c,r]=t.useState(""),[u,d]=t.useState(""),[V,m]=t.useState(!1),[R,x]=t.useState(!1),f=S(),j=N(),h=()=>{const s=new URLSearchParams(f.search);return{email:s.get("email"),token:s.get("token")}};t.useEffect(()=>{const{email:s,token:n}=h(),l=localStorage.getItem("sessionId");s&&n?(async()=>{var v,p;try{const a=await y.get("/sign-up/create-account",{params:{email:s,token:n,sessionId:l}});a.status===200&&a.data.verified?(o("success"),r(`Verification successful. User ${s} moved to permanent table. You can now log in.`)):a.status===409?(o("email_registered"),r(a.data.message||`The email ${s} is already registered.`),x(!0)):(o("failed"),r(a.data.message||"Verification failed."))}catch(a){o("error"),r(((p=(v=a.response)==null?void 0:v.data)==null?void 0:p.message)||"Error verifying the account.")}})():r("Invalid or missing verification details.")},[f.search]);const E=async()=>{var n,l;const{email:s}=h();try{(await y.post("sign-up/resend-verification",{email:s})).status===200?(m(!0),d("Verification email has been resent. Please check your inbox.")):(m(!1),d("Failed to resend verification email. Please try again."))}catch(g){m(!1),d(((l=(n=g.response)==null?void 0:n.data)==null?void 0:l.message)||"Error resending verification email.")}};return e.jsx("div",{className:"general-modal-overlay",children:e.jsxs("div",{className:"modal-inner-content",children:[e.jsx("h2",{children:"Email Verification"}),i==="success"&&e.jsxs("div",{className:"success-message",children:[c,". Completing the process..."]}),i==="email_registered"&&e.jsxs("div",{className:"info-message",children:[c," You can log in to your account.",e.jsx("button",{onClick:()=>j("/login"),children:"Go to Login"})]}),i==="failed"&&e.jsxs("div",{className:"error-message",children:[c,". Please try again or contact support.",e.jsx("button",{onClick:E,children:"Resend Verification Email"})]}),i==="error"&&e.jsx("div",{className:"error-message",children:c}),!i&&e.jsx("div",{className:"loading-message",children:"Verifying your account..."}),u&&e.jsx("div",{className:"resend-message",children:u})]})})};export{w as default};
