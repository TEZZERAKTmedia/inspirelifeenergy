import{r,u as U,j as e,P as E,T as M,a as F}from"./index-DeiqspDO.js";/*! js-cookie v3.0.5 | MIT */function j(t){for(var n=1;n<arguments.length;n++){var p=arguments[n];for(var d in p)t[d]=p[d]}return t}var J={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function C(t,n){function p(o,c,s){if(!(typeof document>"u")){s=j({},n,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in s)s[a]&&(i+="; "+a,s[a]!==!0&&(i+="="+s[a].split(";")[0]));return document.cookie=o+"="+t.write(c,o)+i}}function d(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var c=document.cookie?document.cookie.split("; "):[],s={},i=0;i<c.length;i++){var a=c[i].split("="),m=a.slice(1).join("=");try{var g=decodeURIComponent(a[0]);if(s[g]=t.read(m,g),o===g)break}catch{}}return o?s[o]:s}}return Object.create({set:p,get:d,remove:function(o,c){p(o,"",j({},c,{expires:-1}))},withAttributes:function(o){return C(this.converter,j({},this.attributes,o))},withConverter:function(o){return C(j({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}var f=C(J,{path:"/"});const Y=()=>{const[t,n]=r.useState(!1),[p,d]=r.useState(!1),[o,c]=r.useState(!1),[s,i]=r.useState(!1),[a,m]=r.useState(!1),[g,y]=r.useState(!1),[S,k]=r.useState(!1),[v,D]=r.useState(null),[b,h]=r.useState(!1),[T,x]=r.useState(null);U();const A=async()=>{k(!0),D(null);try{const l=localStorage.getItem("sessionId"),u=f.get("shippingDetails")?JSON.parse(f.get("shippingDetails")):{};console.log("ðŸš€ Sending Metadata to Backend:",u);const R=await F.post("/register-cart/create-checkout-session",{sessionId:l,metadata:{hasAcceptedPrivacy:o,hasAcceptedTermsOfService:s,...u}});window.location.href=R.data.url}catch{D("Failed to initiate checkout.")}finally{k(!1)}},P=()=>{const u={...f.get("shippingDetails")?JSON.parse(f.get("shippingDetails")):{},timestamp:Date.now()};f.set("shippingDetails",JSON.stringify(u),{expires:1}),console.log("âœ… Updated Cookie Before Checkout:",u)};P(),P();const N=l=>{l==="privacy"?o?(x("privacy"),h(!0)):(n(!0),m(!1)):l==="tos"&&(s?(x("tos"),h(!0)):(d(!0),y(!1)))},w=l=>{l==="privacy"?(c(!0),n(!1)):l==="tos"&&(i(!0),d(!1))},B=()=>{T==="privacy"?c(!1):T==="tos"&&i(!1),x(null),h(!1)},O=()=>{x(null),h(!1)},I=()=>{h(!1),n(!1),d(!1)};return e.jsxs("div",{className:"privacy-terms-container",children:[v&&e.jsx("p",{style:{color:"red"},children:v}),e.jsx("h2",{children:"Review Privacy Policy and Terms of Service"}),e.jsxs("div",{className:"toggle-wrapper",children:[e.jsx("span",{className:"toggle-label",children:"Privacy Policy"}),e.jsx("div",{className:`toggle-container ${o?"checked":""}`,onClick:()=>N("privacy"),children:e.jsx("div",{className:"toggle-handle"})})]}),e.jsxs("div",{className:"toggle-wrapper",children:[e.jsx("span",{className:"toggle-label",children:"Terms of Service"}),e.jsx("div",{className:`toggle-container ${s?"checked":""}`,onClick:()=>N("tos"),children:e.jsx("div",{className:"toggle-handle"})})]}),v&&e.jsx("p",{style:{color:"red"},children:v}),e.jsx("button",{onClick:A,disabled:!o||!s||S,style:{marginTop:"20px",padding:"10px 20px",background:o&&s?"green":"gray",color:"white",border:"none",borderRadius:"5px",cursor:o&&s?"pointer":"not-allowed"},children:S?"Processing...":"Accept & Proceed to Checkout"}),t&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx(E,{onReachBottom:()=>m(!0)}),e.jsxs("div",{className:"modal-buttons",children:[e.jsx("button",{onClick:()=>w("privacy"),disabled:!a,children:"Agree"}),e.jsx("button",{onClick:I,children:"I Don't Agree"})]})]})}),p&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx(M,{onReachBottom:()=>y(!0)}),e.jsxs("div",{className:"modal-buttons",children:[e.jsx("button",{onClick:()=>w("tos"),disabled:!g,children:"Agree"}),e.jsx("button",{onClick:I,children:"I Don't Agree"})]})]})}),b&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"Are you sure?"}),e.jsx("p",{children:'Pressing "Yes" means you do not want to use our website.'}),e.jsxs("div",{className:"modal-buttons",children:[e.jsx("button",{onClick:B,children:"Yes"}),e.jsx("button",{onClick:O,children:"Cancel"})]})]})})]})};export{Y as default};
