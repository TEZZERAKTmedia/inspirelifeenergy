import{r,j as e,a as g}from"./index-CTicE-h8.js";const C=()=>{const[c,u]=r.useState([]),[o,x]=r.useState(""),[s,l]=r.useState({line1:"",city:"",state:"",postal_code:""}),[d,n]=r.useState(!1),[h,i]=r.useState(null);r.useEffect(()=>{(async()=>{try{const p=(JSON.parse(localStorage.getItem("cart"))||[]).map(m=>({productId:m.id,quantity:m.quantity}));if(p.length===0){u([]);return}const j=await g.post("/register-cart/items",{items:p});u(j.data.cartDetails||[])}catch(a){console.error("Failed to fetch cart items:",a),i("Failed to fetch cart items. Please try again.")}})()},[]);const y=async t=>{if(t.preventDefault(),n(!0),i(null),!o||!s.line1||!s.city||!s.state||!s.postal_code){i("Please fill out all the fields."),n(!1);return}try{const a=await g.post("/register-cart/create-checkout-session",{cartItems:c,guestEmail:o,shippingAddress:s});window.location.href=a.data.url}catch(a){console.error("Checkout error:",a),i("Failed to initiate checkout. Please try again.")}finally{n(!1)}};return e.jsxs("div",{className:"guest-checkout",children:[e.jsx("h2",{children:"Guest Checkout"}),h&&e.jsx("p",{className:"error-message",children:h}),e.jsxs("form",{onSubmit:y,children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",value:o,onChange:t=>x(t.target.value),placeholder:"Enter your email",required:!0}),e.jsx("label",{children:"Shipping Address:"}),e.jsx("input",{type:"text",placeholder:"Street Address",value:s.line1,onChange:t=>l({...s,line1:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"City",value:s.city,onChange:t=>l({...s,city:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"State",value:s.state,onChange:t=>l({...s,state:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"Postal Code",value:s.postal_code,onChange:t=>l({...s,postal_code:t.target.value}),required:!0}),e.jsx("button",{type:"submit",disabled:d,children:d?"Processing...":"Proceed to Payment"})]}),e.jsxs("div",{className:"cart-summary",children:[e.jsx("h3",{children:"Cart Summary"}),c.length>0?c.map(t=>e.jsxs("div",{className:"cart-item",children:[e.jsxs("p",{children:[e.jsx("strong",{children:t.name})," x ",t.quantity]}),e.jsxs("p",{children:["$",(t.price/100).toFixed(2)]})]},t.id)):e.jsx("p",{children:"Your cart is empty."})]})]})};export{C as default};
