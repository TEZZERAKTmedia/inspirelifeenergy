import{j as e,L as D,r as n,a as S,u as E}from"./index-CLdnT_mv.js";import{L as B}from"./loading-Bs68Rwsp.js";const z=({message:t,onClose:d})=>{const u=()=>{window.location.href="/store"};return e.jsx("div",{style:f.backdrop,onClick:d,children:e.jsxs("div",{style:f.modal,onClick:c=>c.stopPropagation(),children:[e.jsx("h3",{style:f.heading,children:"Item Added to Cart"}),e.jsx("p",{style:f.message,children:t}),e.jsxs("div",{style:f.buttonWrapper,children:[e.jsx(D,{to:"/cart",children:e.jsx("button",{style:f.cartButton,children:"Go to Cart"})}),e.jsx("button",{style:f.shopButton,onClick:u,children:"Keep Shopping"})]})]})})},f={backdrop:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"#fff",borderRadius:"10px",padding:"20px",textAlign:"center",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)",maxWidth:"300px",width:"90%"},heading:{fontSize:"1.5rem",marginBottom:"10px"},message:{fontSize:"1rem",color:"#555",marginBottom:"20px"},buttonWrapper:{display:"flex",justifyContent:"space-between",gap:"10px"},cartButton:{padding:"10px 15px",background:"linear-gradient(to right, #007bff, #0056b3)",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",flex:1},shopButton:{padding:"10px 15px",background:"linear-gradient(to right, #28a745, #218838)",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",flex:1}},L=({product:t,maxQuantity:d,onClose:u,onViewCart:c})=>{const[a,l]=n.useState(1),[o,i]=n.useState(!1),g=()=>{a<d&&l(a+1)},x=()=>{a>1&&l(a-1)},j=r=>{const p=parseInt(r.target.value,10);!p||p<1?l(1):p>d?l(d):l(p)},b=async()=>{const r=N();if(!r){alert("Session ID is missing. Unable to add to cart.");return}try{await S.post("/register-cart/add-guest-cart",{sessionId:r,productId:t.id,quantity:a}),i(!0),console.log(`${a} x ${t.name} added to cart!`)}catch(p){console.error("Error adding item to guest cart:",p),alert("An error occurred while adding the item to the cart. Please try again.")}},N=()=>{let r=localStorage.getItem("sessionId");return r||(r=`guest_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("sessionId",r)),r};return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:m.backdrop,onClick:u,children:e.jsxs("div",{style:m.modal,onClick:r=>r.stopPropagation(),children:[e.jsx("h3",{style:m.heading,children:"Select Quantity"}),e.jsxs("div",{style:m.quantityWrapper,children:[e.jsx("button",{style:m.button,onClick:x,children:"-"}),e.jsx("input",{type:"number",value:a,onChange:j,min:"1",max:d,style:m.input}),e.jsx("button",{style:m.button,onClick:g,children:"+"})]}),e.jsxs("p",{style:m.stockInfo,children:["Available: ",d]}),e.jsx("button",{style:m.addToCartButton,onClick:b,children:"Add to Cart"}),e.jsx("button",{style:m.cancelButton,onClick:u,children:"Cancel"})]})}),o&&e.jsx(z,{message:`${a} x ${t.name} added to your cart!`,onConfirm:c,onCancel:()=>i(!1)})]})},m={backdrop:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"#ffffff",borderRadius:"10px",textAlign:"center",padding:"30px 20px",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)",maxWidth:"400px",width:"90%",position:"relative"},heading:{fontSize:"1.5rem",marginBottom:"20px",color:"#333"},quantityWrapper:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"20px"},button:{display:"flex",alignItems:"center",justifyContent:"center",color:"white",padding:"0",fontSize:"1.5rem",background:"black",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer",width:"40px",height:"40px",lineHeight:"1"},input:{width:"60px",textAlign:"center",fontSize:"1rem",padding:"5px",border:"1px solid #ccc",borderRadius:"5px",marginTop:"15px"},stockInfo:{fontSize:"0.9rem",color:"#666",marginBottom:"20px"},addToCartButton:{padding:"10px 20px",background:"linear-gradient(to right, #28a745, #218838)",color:"#fff",fontSize:"1rem",border:"none",borderRadius:"5px",cursor:"pointer",margin:"10px"},cancelButton:{padding:"10px 20px",background:"linear-gradient(to right, #dc3545, #c82333)",color:"#fff",fontSize:"1rem",border:"none",borderRadius:"5px",cursor:"pointer"}},T=({product:t,onClose:d})=>{const[u,c]=n.useState(!1),[a,l]=n.useState(0),[o,i]=n.useState([]),[g,x]=n.useState(!0),[j,b]=n.useState(0),N=E(),r=t.isDiscounted,p=r?parseFloat(t.discountPrice).toFixed(2):null,s=r?new Date(t.discountEndDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;n.useEffect(()=>{(async()=>{try{const F=(await S.get(`/register-store/products/${t.id}/media`)).data||[],I=[{id:"thumbnail",url:t.thumbnail,type:"image",order:0},...F.sort((M,A)=>M.order-A.order)];i(I)}catch(v){console.error("Error fetching media:",v),i([{id:"thumbnail",url:t.thumbnail,type:"image",order:0}])}finally{x(!1)}})()},[t.id,t.thumbnail]);const y=()=>c(!0),C=()=>c(!1),k=()=>a<o.length-1&&l(h=>h+1),w=()=>a>0&&l(h=>h-1),$=h=>b(h.touches[0].clientX),P=h=>{const v=j-h.touches[0].clientX;v>50?k():v<-50&&w()};return e.jsx("div",{className:"product-modal-overlay",onClick:d,children:e.jsxs("div",{className:"product-modal-container",onClick:h=>h.stopPropagation(),children:[g?e.jsx("p",{className:"product-modal-loading",children:"Loading media..."}):o.length>0?e.jsxs("div",{className:"product-modal-carousel",onTouchStart:$,onTouchMove:P,children:[e.jsx("div",{className:"product-modal-slide",children:o[a].type==="image"?e.jsx("img",{src:`http://localhost:3450/uploads/${o[a].url}`,alt:`Media ${a+1}`,className:"product-modal-media"}):e.jsx("video",{src:`http://localhost:3450/uploads/${o[a].url}`,controls:!0,className:"product-modal-media"})}),e.jsxs("div",{className:"product-modal-arrow-container",children:[e.jsx("button",{className:"product-modal-arrow",onClick:w,disabled:a===0,children:"‹"}),e.jsx("button",{className:"product-modal-arrow",onClick:k,disabled:a===o.length-1,children:"›"})]})]}):e.jsx("p",{className:"product-modal-no-media",children:"No media available."}),e.jsxs("div",{className:"product-modal-info",children:[e.jsx("div",{className:"form-section",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"product-modal-price",children:[e.jsx("span",{className:"product-modal-label",children:"Original Price: "}),e.jsxs("span",{className:"product-modal-original-price",children:["$",parseFloat(t.price).toFixed(2)]})]}),e.jsxs("p",{className:"product-modal-price",children:[e.jsx("span",{className:"product-modal-label",children:"Discounted Price: "}),e.jsxs("span",{className:"product-modal-discounted-price",children:["$",p]})]}),e.jsx("div",{className:"product-modal-details-grid",children:e.jsxs("p",{className:"product-modal-sale-end",children:[e.jsx("span",{className:"sale-end-product-modal-label",children:"Sale Ends: "}),s]})})]}):e.jsxs("p",{className:"product-modal-details-grid",children:[e.jsx("span",{className:"product-modal-label",children:"Price: "}),e.jsxs("span",{className:"product-modal-normal-price",children:["$",parseFloat(t.price).toFixed(2)]})]})}),e.jsx("div",{className:"product-modal-button-container",children:e.jsx("button",{className:"product-modal-purchase-button",onClick:y,children:"Purchase"})}),e.jsxs("div",{className:"product-modal-details-grid",children:[e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label"}),e.jsx("h2",{className:"product-modal-title",children:t.name})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Description:"}),e.jsx("div",{className:"grid-value product-modal-description",children:t.description})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Dimensions:"}),e.jsxs("div",{className:"grid-value product-modal-dimension-content",children:[e.jsxs("p",{children:["Length: ",(t.length*2.54).toFixed(2)," cm | ",t.length," in"]}),e.jsxs("p",{children:["Width: ",(t.width*2.54).toFixed(2)," cm | ",t.width," in"]}),e.jsxs("p",{children:["Height: ",(t.height*2.54).toFixed(2)," cm | ",t.height," in"]})]})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Weight:"}),e.jsxs("div",{className:"grid-value",children:[t.weight," lbs"]})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Quantity Available:"}),e.jsx("div",{className:"grid-value",children:t.quantity})]})]})]}),u&&e.jsx(L,{product:t,maxQuantity:t.quantity,onClose:C,onAddToCart:()=>console.log("Added to cart!"),onViewCart:()=>N("/cart")})]})})},R=({onTypeSelect:t})=>{const[d,u]=n.useState([]),[c,a]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const i=await S.get("/register-store/product-types");console.log(i.data),u(i.data)}catch(i){console.error("Error fetching product types:",i)}})()},[]);const l=o=>{t(o),a(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`store-navbar ${c?"open":""}`,children:[e.jsx("button",{className:"close-button",onClick:()=>a(!1),children:"✕"}),e.jsxs("div",{className:"store-navbar-content",children:[e.jsx("button",{className:"all-products",onClick:()=>l("All"),children:"All Products"}),d.map((o,i)=>e.jsxs("div",{onClick:()=>l(o.type),className:"store-navbar-section",children:[e.jsxs("h2",{className:"store-navbar-title",onClick:()=>l(o.type),children:[o.type,"s"]}),e.jsx("div",{className:"thumbnail-container",children:Array.isArray(o.thumbnails)&&o.thumbnails.length>0?o.thumbnails.slice(0,3).map((g,x)=>e.jsx("img",{src:`http://localhost:3450/uploads/${g}`,alt:`Thumbnail for ${o.type}`},`${o.type}-${x}`)):e.jsx("p",{children:"No products"})})]},`${o.type}-${i}`))]})]}),!c&&e.jsx("button",{className:"reopen-button",onClick:()=>a(!0),children:"Menu"})]})},q=()=>{const[t,d]=n.useState([]),[u,c]=n.useState([]),[a,l]=n.useState("All"),[o,i]=n.useState(null),[g,x]=n.useState(!0),[j,b]=n.useState(null);n.useEffect(()=>{N()},[]);const N=async()=>{x(!0),b(null);try{const s=await S.get("/register-store/products");d(s.data.products||[]),c(s.data.products||[])}catch(s){console.error("Error fetching products:",s),b("Failed to load products. Please try again later.")}finally{x(!1)}};n.useEffect(()=>{c(a==="All"?t:t.filter(s=>s.type===a))},[a,t]);const r=s=>{i(s)},p=()=>{i(null)};return g||j?e.jsxs("div",{className:"full-page-loading-overlay",children:[e.jsx(B,{}),j&&e.jsx("p",{style:{color:"red",position:"absolute",zIndex:"1000",fontSize:"1rem",bottom:"20%",backgroundColor:"white",padding:"10px",borderRadius:"10px"},children:j})]}):e.jsxs(e.Fragment,{children:[o&&e.jsx(T,{product:o,onClose:p}),e.jsx(R,{onTypeSelect:s=>l(s)}),e.jsx("div",{className:"store-container",children:e.jsx("div",{className:"store-product-grid",children:u.length>0?u.map(s=>{const y=s.isDiscounted,C=y?new Date(s.discountEndDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;return e.jsxs("div",{className:"store-product-tile",onClick:()=>r(s),children:[e.jsxs("div",{className:"store-product-image",children:[e.jsx("img",{src:`http://localhost:3450/uploads/${s.thumbnail}`,alt:s.name}),y&&e.jsx("div",{className:"store-discount-tag",children:s.discountType==="percentage"?`-${parseFloat(s.discountAmount).toFixed(2)}%`:`-$${parseFloat(s.discountAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"store-product-info",children:[e.jsx("h3",{className:"store-product-info__title",children:s.name}),e.jsx("div",{className:"store-product-price",children:y?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"store-product-price__original",children:["$",parseFloat(s.price).toFixed(2)]}),e.jsxs("p",{className:"store-product-price__discounted",children:["$",parseFloat(s.discountPrice).toFixed(2)]})]}):e.jsxs("p",{className:"store-product-price__active",children:["$",parseFloat(s.price).toFixed(2)]})}),y&&e.jsxs("p",{className:"store-sale-end",children:["Sale Ends: ",C]})]})]},s.id)}):e.jsx("p",{className:"store-no-products",children:"No products available or still loading..."})})})]})};export{q as default};
